@model ApplicationUser
@inject IApplicationUserServices Service
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@inject IUtilityService UtilityService

@{
    ViewBag.Title = "About";
    Layout = "_Layout";
}

<environment include="Development">
    <link rel="stylesheet" href="~/css/About.css" />
</environment>

<br/>
<div class="container">
    <div class="row">
        <div class="col-4 col-md-4 text-left">
            <h7>
                <i>
                    <small>
                        Also known as..
                    </small>
                </i>
            </h7>
        </div>
    </div>
    <div class="row">
        <div class="offset-1 col-md-4 col-4">
            <h3>
                @Model.FirstName @Model.LastName
            </h3>
        </div>
    </div>
</div>
<br />
<div class="container border">
    <div class="row">
        <div class="offset-8 col-4 col-md-4 text-right">
            <h7>
                <i>
                    <small>
                        Short Description
                    </small>
                </i>
            </h7>
        </div>
    </div>
    <div class="row justify-content-center">
        <h5>
            @Model.Description
        </h5>
    </div>
    <br/>
</div>
<br />
<div class="container border">
    <div class="row text-left">
        <div class="col-md-12 col-12">
            <h4 class="text-left">
                <i>
                    Favorites
                </i>
            </h4>
        </div>
    </div>
    <div class="row">
        <div class="offset-1 col-10 col-md-10 favoritesDiv">
            @{
                var books = Model.Books.ToList();
                if (books.Count == 0)
                {
                    <h4>
                        Ops! Seems like it's nothing here yet..
                    </h4>
                    <h4>
                        Start browsing <a asp-controller="Books" asp-action="Index"> here</a> !
                    </h4>
                }
                else
                {
                @*<div class="row ">
                    <div id="favoriteBooks" class="carousel" data-ride="carousel">
                        <div class="carousel-inner">                            
                            <div class="carousel-item active">
                                    <div class="row">
                                        <div class="col-md-3 col-3 favoriteBooks">
                                            <a asp-controller="Books" asp-action="Details" asp-route-id="@book.Id" data-toggle="tooltip" data-placement="right" data-html="true" title="DA">
                                                <img class="rounded" src="@Url.Content("..\\..\\images\\" + book.Folder + "\\" + book.ImageName)" />
                                            </a>
                                        </div>
                                        @for (var index = 0; index < books.Count; ++index)
                                        {
                                            var book = UtilityService.GetBookById(books[index].TargetId);
                                            var displayInfo = "<h4>" + book.Title + "</h4><p>" + book.Description + "</p>";
                                            var checkIndex = index + 1;
                                            var activeItem = " active";
                                            if (checkIndex > 4)
                                            {
                                                activeItem = "";
                                            }

                                            <div class="col-md-3 col-3 favoriteBooks">
                                                <a asp-controller="Books" asp-action="Details" asp-route-id="@book.Id" data-toggle="tooltip" data-placement="right" data-html="true" title="@displayInfo">
                                                    <img class="rounded" src="@Url.Content("..\\..\\images\\" + book.Folder + "\\" + book.ImageName)"/>
                                                </a>
                                            </div>
                                        }
                                    </div>
                            </div>
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#favoriteBooks" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-prev" href="#favoriteBooks" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>*@
                }
            }
        </div>
    </div>
</div>
<br/>
<div class="row text-left">
    <div class="col-md-12 col-12">
        <h4 class="text-left">
            <i>
                Comments
            </i>
        </h4>
    </div>
</div>
<div class="container border">
    @if (SignInManager.IsSignedIn(User))
    {
        var userId = UserManager.GetUserId(User);
        <div class="media p-3">
            <img class="mr-3 rounded" id="reviewPicture" src="@Url.Content("..\\..\\" + Service.GetFolderWithFile(userId))" />
            <div class="media-body textAlign">
                <form asp-controller="Posts" asp-action="Create" class="submitPost" role="form">
                    @Html.Hidden("userId", Guid.Parse(userId))
                    @Html.Hidden("targetId", Model.Id)
                    <input type="text" name="postText" placeholder="Say something.." />
                    <button type="button" id="reviewButton" class="btn textButton"></button>
                </form>
            </div>
        </div>
    }

    <div id="@Model.Id">
        @Html.Partial("PartialViews/_PostsDisplay", Model.Posts)
    </div>
</div>